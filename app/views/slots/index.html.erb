<% provide(:page_title, 'Listing Slots') %>

<div id="container">
  <div class="page-header">
    <h2>I GOT TALENT <small>SCHEDULE</small></h2>
  </div>

  <p id="notice"><%= notice %></p>

  <% if flash[:message] %>
      <div class="alert alert-success">
        flash[:message]
      </div>
  <% end %>

<p>Check out latest <em>I Got Talent</em> events!</p>

<p>Wanna share your talent? <%= link_to 'Upload now!', new_video_path, class: 'btn-sm btn-success' %></p>

  <!-- Popular videos -->
  <div class="page-header">
    <h1 style="font-variant: small-caps;">Popular <small>Videos most visited by everyone</small></h1>
  </div>
  <div class="row">
    <nav class="col-lg-1">
        <ul class="pager">
          <li class="pager-prev <%= 'disabled' unless @slots.previous_page %>" style="float: left;"><a href=<%= @slots.current_page == 1 ? '#' : "/slots/?page=#{@slots.previous_page}" %>>Newer</a></li>
        </ul>
    </nav>
    <% @slots.each do |slot| %>
        <% if slot.video and live?(slot) %>
        <div class="col-lg-3">
          <div class="panel <%= live?(slot) ? "panel-success" : "panel-default" %>">
            <div class="panel-heading">
              <em><%= "\"#{slot.video.title}\"" %></em>
              by
              <strong><%= slot.video.user.name %></strong>
            </div>
            <div class="panel-body">
              <% if live?(slot) %>
                  <!-- 4:3 aspect ratio -->
                  <div class="embed-responsive embed-responsive-16by9">
                  <!--<div class="embed-responsive embed-responsive-4by3">-->
                    <iframe width="290" height="165" src="<%= "https://www.youtube.com/embed/#{youtube_video_id_of(slot.video)}" %>" class="embed-responsive-item" frameborder="0" allowfullscreen></iframe>
                  </div>
                  <br>
                  <div style="float: left;">
                    <!-- Current user didn't like this video before? -->
                    <% unless Like.liked?( slot.video.id, current_user.id ) %>
                      <i class="fa fa-thumbs-o-up" style="font-size: 18px;" aria-hidden="true"></i>
                      <%= link_to 'Like', "/slots/#{slot.video.id}/like", method: :post, class: 'btn btn-success btn-xs' %>
                    <% else %>
                      <i class="fa fa-thumbs-up" style="font-size: 18px;" aria-hidden="true"></i>
                    <% end %>
                    <!-- How many people liked this video? -->
                    <small><%= Like.like_count( slot.video.id ) %></small>
                  </div>

                  <div style="float: right;;">
                    <!-- Current user didn't dislike this video before? -->
                    <small><%= Like.dislike_count( slot.video.id ) %></small>
                    <% unless Like.disliked?( slot.video.id, current_user.id ) %>
                        <%= link_to 'Dislike', "/slots/#{slot.video.id}/dislike", method: :post, class: 'btn btn-danger btn-xs' %>
                        <i class="fa fa-thumbs-o-down" style="font-size: 18px;" aria-hidden="true"></i>
                    <% else %>
                        <i class="fa fa-thumbs-down" style="font-size: 18px;" aria-hidden="true"></i>
                    <% end %>
                  </div>
              <% else %>
                  <address>
                    <strong><%= slot.video.user.name %></strong><br>
                    Starts on <strong><%= slot.start_time.strftime('%a %I:%M %p') %></strong><br>
                    <span class="label label-primary"><%= slot.genre %></span>
                    <br><br>
                    <abbr title="Genres">Coming soon.</abbr>
                  </address>
              <% end %>
            </div>
          </div>
        </div>
        <% end %>
    <% end %>
    <% ( (@slots.size+1)..3).each do %>
        <div class="col-lg-3">
          <div class="panel panel-success">
            <div class="panel-heading">...</div>
            <div class="panel-body">...</div>
          </div>
        </div>
    <% end %>
    <nav class="col-lg-1">
        <ul class="pager">
          <li class="pager-prev  <%= 'disabled' unless @slots.next_page %>"><a href=<%= @slots.current_page == @slots.total_pages ? '#' : "/slots/?page=#{@slots.next_page}" %>>Older</a></li>
        </ul>
    </nav>
  </div>

  <!-- Latest Videos -->
  <div class="page-header">
    <h1 style="font-variant: small-caps;">Latest <small>Stay up to date with new stuff</small></h1>
  </div>
 <div class="row">
     <div class="col-lg-1"></div>
    <% @slots.each do |slot| %>
        <% if slot.video and live?(slot) %>
        <div class="col-lg-3">
          <div class="panel <%= live?(slot) ? "panel-success" : "panel-default" %>">
            <div class="panel-heading">
              <em><%= "\"#{slot.video.title}\"" %></em>
              by
              <strong><%= slot.video.user.name %></strong>
            </div>
            <div class="panel-body">
              <% if live?(slot) %>
                  <!-- 4:3 aspect ratio -->
                  <div class="embed-responsive embed-responsive-16by9">
                  <!--<div class="embed-responsive embed-responsive-4by3">-->
                    <iframe width="290" height="165" src="<%= "https://www.youtube.com/embed/#{youtube_video_id_of(slot.video)}" %>" class="embed-responsive-item" frameborder="0" allowfullscreen></iframe>
                  </div>
                  <br>
                  <div style="float: left;">
                    <!-- Current user didn't like this video before? -->
                    <% unless Like.liked?( slot.video.id, current_user.id ) %>
                      <i class="fa fa-thumbs-o-up" style="font-size: 18px;" aria-hidden="true"></i>
                      <%= link_to 'Like', "/slots/#{slot.video.id}/like", method: :post, class: 'btn btn-success btn-xs' %>
                    <% else %>
                      <i class="fa fa-thumbs-up" style="font-size: 18px;" aria-hidden="true"></i>
                    <% end %>
                    <!-- How many people liked this video? -->
                    <small><%= Like.like_count( slot.video.id ) %></small>
                  </div>

                  <div style="float: right;;">
                    <!-- Current user didn't dislike this video before? -->
                    <small><%= Like.dislike_count( slot.video.id ) %></small>
                    <% unless Like.disliked?( slot.video.id, current_user.id ) %>
                        <%= link_to 'Dislike', "/slots/#{slot.video.id}/dislike", method: :post, class: 'btn btn-danger btn-xs' %>
                        <i class="fa fa-thumbs-o-down" style="font-size: 18px;" aria-hidden="true"></i>
                    <% else %>
                        <i class="fa fa-thumbs-down" style="font-size: 18px;" aria-hidden="true"></i>
                    <% end %>
                  </div>
              <% else %>
                  <address>
                    <strong><%= slot.video.user.name %></strong><br>
                    Starts on <strong><%= slot.start_time.strftime('%a %I:%M %p') %></strong><br>
                    <span class="label label-primary"><%= slot.genre %></span>
                    <br><br>
                    <abbr title="Genres">Coming soon.</abbr>
                  </address>
              <% end %>
            </div>
          </div>
        </div>
        <% end %>
    <% end %>

    <% ( (@slots.size+1)..3).each do %>
       <div class="col-lg-3">
         <div class="panel panel-success">
           <div class="panel-heading">...</div>
           <div class="panel-body">...</div>
         </div>
       </div>
    <% end %>

   <div style="clear: both;">
    <%= will_paginate style: 'margin-left: 365px;' %>
   </div>

  </div>

  <!-- Recommended Videos -->
  <div class="page-header">
    <h1 style="font-variant: small-caps;">Recommended <small>We think you will like these videos</small></h1>
  </div>
  <div class="row">
    <div class="col-lg-1"></div>
    <% @slots.each do |slot| %>
        <% if slot.video and live?(slot) %>
            <div class="col-lg-3">
              <div class="panel <%= live?(slot) ? "panel-success" : "panel-default" %>">
                <div class="panel-heading">
                  <em><%= "\"#{slot.video.title}\"" %></em>
                  by
                  <strong><%= slot.video.user.name %></strong>
                </div>
                <div class="panel-body">
                  <% if live?(slot) %>
                      <!-- 4:3 aspect ratio -->
                      <div class="embed-responsive embed-responsive-16by9">
                        <!--<div class="embed-responsive embed-responsive-4by3">-->
                        <iframe width="290" height="165" src="<%= "https://www.youtube.com/embed/#{youtube_video_id_of(slot.video)}" %>" class="embed-responsive-item" frameborder="0" allowfullscreen></iframe>
                      </div>
                      <br>
                      <div style="float: left;">
                        <!-- Current user didn't like this video before? -->
                        <% unless Like.liked?( slot.video.id, current_user.id ) %>
                          <i class="fa fa-thumbs-o-up" style="font-size: 18px;" aria-hidden="true"></i>
                          <%= link_to 'Like', "/slots/#{slot.video.id}/like", method: :post, class: 'btn btn-success btn-xs' %>
                        <% else %>
                          <i class="fa fa-thumbs-up" style="font-size: 18px;" aria-hidden="true"></i>
                        <% end %>
                        <!-- How many people liked this video? -->
                        <small><%= Like.like_count( slot.video.id ) %></small>
                      </div>

                      <div style="float: right;;">
                        <!-- Current user didn't dislike this video before? -->
                        <small><%= Like.dislike_count( slot.video.id ) %></small>
                        <% unless Like.disliked?( slot.video.id, current_user.id ) %>
                            <%= link_to 'Dislike', "/slots/#{slot.video.id}/dislike", method: :post, class: 'btn btn-danger btn-xs' %>
                            <i class="fa fa-thumbs-o-down" style="font-size: 18px;" aria-hidden="true"></i>
                        <% else %>
                            <i class="fa fa-thumbs-down" style="font-size: 18px;" aria-hidden="true"></i>
                        <% end %>
                      </div>
                  <% else %>
                      <address>
                        <strong><%= slot.video.user.name %></strong><br>
                        Starts on <strong><%= slot.start_time.strftime('%a %I:%M %p') %></strong><br>
                        <span class="label label-primary"><%= slot.genre %></span>
                        <br><br>
                        <abbr title="Genres">Coming soon.</abbr>
                      </address>
                  <% end %>
                </div>
              </div>
            </div>
        <% end %>
    <% end %>

    <% ( (@slots.size+1)..3).each do %>
        <div class="col-lg-3">
          <div class="panel panel-success">
            <div class="panel-heading">...</div>
            <div class="panel-body">...</div>
          </div>
        </div>
    <% end %>

  </div>
  <nav>
      <ul class="pager">
        <li class="pager-prev <%= 'disabled' unless @slots.previous_page %>" style="float: left;"><a href=<%= @slots.current_page == 1 ? '#' : "/?page=#{@slots.previous_page}" %>>Newer</a></li>
        <li class="pager-prev  <%= 'disabled' unless @slots.next_page %>" style="float: right;"><a href=<%= @slots.current_page == @slots.total_pages ? '#' : "/?page=#{@slots.next_page}" %>>Older</a></li>
      </ul>
  </nav>

  <br>

<!--<%= link_to '+New Time Slot', new_slot_path, class: "btn btn-warning" %>-->

</div>